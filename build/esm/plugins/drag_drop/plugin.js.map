{"version":3,"file":"plugin.js","sources":["../../../../src/plugins/drag_drop/plugin.ts"],"sourcesContent":["/**\r\n * Plugin: \"drag_drop\" (Tom Select)\r\n * Copyright (c) contributors\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n * file except in compliance with the License. You may obtain a copy of the License at:\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software distributed under\r\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n * ANY KIND, either express or implied. See the License for the specific language\r\n * governing permissions and limitations under the License.\r\n *\r\n */\r\n\r\nimport TomSelect from '../../tom-select';\r\n\r\nexport default function(this:TomSelect) {\r\n\tvar self = this;\r\n\tif (!$.fn.sortable) throw new Error('The \"drag_drop\" plugin requires jQuery UI \"sortable\".');\r\n\tif (self.settings.mode !== 'multi') return;\r\n\r\n\tvar orig_lock\t\t= self.lock;\r\n\tvar orig_unlock\t\t= self.unlock;\r\n\r\n\tself.hook('instead','lock',()=>{\r\n\t\tvar sortable = $(self.control).data('sortable');\r\n\t\tif (sortable) sortable.disable();\r\n\t\treturn orig_lock.call(self);\r\n\t});\r\n\r\n\tself.hook('instead','unlock',()=>{\r\n\t\tvar sortable = $(self.control).data('sortable');\r\n\t\tif (sortable) sortable.enable();\r\n\t\treturn orig_unlock.call(self);\r\n\t});\r\n\r\n\tself.on('initialize',()=>{\r\n\t\tvar $control = $(self.control).sortable({\r\n\t\t\titems: '[data-value]',\r\n\t\t\tforcePlaceholderSize: true,\r\n\t\t\tdisabled: self.isLocked,\r\n\t\t\tstart: (e, ui) => {\r\n\t\t\t\tui.placeholder.css('width', ui.helper.css('width'));\r\n\t\t\t\t$control.css({overflow: 'visible'});\r\n\t\t\t},\r\n\t\t\tstop: ()=>{\r\n\t\t\t\t$control.css({overflow: 'hidden'});\r\n\r\n\t\t\t\tvar values:string[] = [];\r\n\t\t\t\t$control.children('[data-value]').each(function(this:HTMLElement){\r\n\t\t\t\t\tif( this.dataset.value ) values.push(this.dataset.value);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tself.setValue(values);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n};\r\n"],"names":["self","$","fn","sortable","Error","settings","mode","orig_lock","lock","orig_unlock","unlock","hook","control","data","disable","call","enable","on","$control","items","forcePlaceholderSize","disabled","isLocked","start","e","ui","placeholder","css","helper","overflow","stop","values","children","each","dataset","value","push","setValue"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIe,mBAAyB;AACvC,MAAIA,IAAI,GAAG,IAAX;AACA,MAAI,CAACC,CAAC,CAACC,EAAF,CAAKC,QAAV,EAAoB,MAAM,IAAIC,KAAJ,CAAU,uDAAV,CAAN;AACpB,MAAIJ,IAAI,CAACK,QAAL,CAAcC,IAAd,KAAuB,OAA3B,EAAoC;AAEpC,MAAIC,SAAS,GAAIP,IAAI,CAACQ,IAAtB;AACA,MAAIC,WAAW,GAAIT,IAAI,CAACU,MAAxB;AAEAV,EAAAA,IAAI,CAACW,IAAL,CAAU,SAAV,EAAoB,MAApB,EAA2B,MAAI;AAC9B,QAAIR,QAAQ,GAAGF,CAAC,CAACD,IAAI,CAACY,OAAN,CAAD,CAAgBC,IAAhB,CAAqB,UAArB,CAAf;AACA,QAAIV,QAAJ,EAAcA,QAAQ,CAACW,OAAT;AACd,WAAOP,SAAS,CAACQ,IAAV,CAAef,IAAf,CAAP;AACA,GAJD;AAMAA,EAAAA,IAAI,CAACW,IAAL,CAAU,SAAV,EAAoB,QAApB,EAA6B,MAAI;AAChC,QAAIR,QAAQ,GAAGF,CAAC,CAACD,IAAI,CAACY,OAAN,CAAD,CAAgBC,IAAhB,CAAqB,UAArB,CAAf;AACA,QAAIV,QAAJ,EAAcA,QAAQ,CAACa,MAAT;AACd,WAAOP,WAAW,CAACM,IAAZ,CAAiBf,IAAjB,CAAP;AACA,GAJD;AAMAA,EAAAA,IAAI,CAACiB,EAAL,CAAQ,YAAR,EAAqB,MAAI;AACxB,QAAIC,QAAQ,GAAGjB,CAAC,CAACD,IAAI,CAACY,OAAN,CAAD,CAAgBT,QAAhB,CAAyB;AACvCgB,MAAAA,KAAK,EAAE,cADgC;AAEvCC,MAAAA,oBAAoB,EAAE,IAFiB;AAGvCC,MAAAA,QAAQ,EAAErB,IAAI,CAACsB,QAHwB;AAIvCC,MAAAA,KAAK,EAAE,CAACC,CAAD,EAAIC,EAAJ,KAAW;AACjBA,QAAAA,EAAE,CAACC,WAAH,CAAeC,GAAf,CAAmB,OAAnB,EAA4BF,EAAE,CAACG,MAAH,CAAUD,GAAV,CAAc,OAAd,CAA5B;AACAT,QAAAA,QAAQ,CAACS,GAAT,CAAa;AAACE,UAAAA,QAAQ,EAAE;AAAX,SAAb;AACA,OAPsC;AAQvCC,MAAAA,IAAI,EAAE,MAAI;AACTZ,QAAAA,QAAQ,CAACS,GAAT,CAAa;AAACE,UAAAA,QAAQ,EAAE;AAAX,SAAb;AAEA,YAAIE,MAAe,GAAG,EAAtB;AACAb,QAAAA,QAAQ,CAACc,QAAT,CAAkB,cAAlB,EAAkCC,IAAlC,CAAuC,YAA0B;AAChE,cAAI,KAAKC,OAAL,CAAaC,KAAjB,EAAyBJ,MAAM,CAACK,IAAP,CAAY,KAAKF,OAAL,CAAaC,KAAzB;AACzB,SAFD;AAIAnC,QAAAA,IAAI,CAACqC,QAAL,CAAcN,MAAd;AACA;AAjBsC,KAAzB,CAAf;AAoBA,GArBD;AAuBA;;;;"}